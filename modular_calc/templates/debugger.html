<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOM Diagnostics</title>
    
    <!-- Standard CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8">

    <!-- THE UI LAYER -->
    <div x-data="engineDebugger()" class="max-w-2xl mx-auto" x-cloak>
        
        <div class="bg-white rounded-t-lg shadow-sm border-b p-6">
            <h1 class="text-xl font-bold text-gray-800">Engine Diagnostic Tool</h1>
            <p class="text-sm text-gray-500">Run this to identify configuration errors in your BOM generation.</p>
        </div>

        <!-- Action Area -->
        <div class="bg-white p-6 shadow-sm mb-4">
            <div class="flex items-center justify-between">
                <div>
                    <span class="block text-sm font-medium text-gray-700">Product: #<span x-text="productId"></span></span>
                </div>
                <button 
                    @click="runAnalysis()" 
                    :disabled="loading"
                    class="inline-flex items-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-md transition disabled:opacity-50"
                >
                    <span x-show="!loading">Run Diagnostics</span>
                    <span x-show="loading">Analyzing...</span>
                </button>
            </div>
        </div>

        <!-- Results -->
        <div x-show="hasRun" class="space-y-3">
            <h2 class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Results</h2>
            
            <template x-if="issues.length > 0">
                <div class="space-y-2">
                    <template x-for="(issue, index) in issues" :key="index">
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded shadow-sm">
                            <p class="text-sm text-yellow-700" x-text="issue"></p>
                        </div>
                    </template>
                </div>
            </template>

            <template x-if="issues.length === 0">
                <div class="bg-green-50 border border-green-200 p-6 rounded-lg text-center">
                    <p class="text-green-800 font-bold text-sm">Perfect! No issues detected.</p>
                </div>
            </template>
        </div>
    </div>

    <!-- THE LOGIC LAYER (Script at the bottom) -->
    <!-- We load Alpine AFTER the function is defined to avoid "undefined" errors -->
    <script>
        function engineDebugger() {
            return {
                productId: 123,
                issues: [],
                loading: false,
                hasRun: false,

                async runAnalysis() {
                    this.loading = true;
                    this.hasRun = false;
                    
                    // Simulate a delay
                    setTimeout(() => {
                        this.issues = [
                            "Height is set to 0 in the global variables.",
                            "Template 'Panel_A' is missing a valid width parameter.",
                            "No material found for index 4."
                        ];
                        this.loading = false;
                        this.hasRun = true;
                    }, 800);
                }
            }
        }
    </script>

    <!-- Load Alpine last -->
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

</body>
</html>