<!-- ================= PART TEMPLATE MODAL ================= -->
<div class="modal fade" id="partTemplateModal" tabindex="-1">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Part Template</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">

        <!-- PART NAME -->
        <h5 class="modal-title">
  Part Template:
  <div class="mb-3">
    <label class="form-label fw-bold">Part Name</label>
    <input type="text" id="part-template-name" class="form-control text-primary fw-bold" placeholder="Enter part name..." disabled>
</div>
  
</h5>

        <!-- TABS -->
        <ul class="nav nav-tabs mb-2">
          <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#pt-geometry">Geometry</a></li>
          <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#pt-material">Material</a></li>
          <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#pt-hardware">Hardware</a></li>
        </ul>

        <div class="tab-content">
<div class="tab-pane fade show active" id="pt-geometry">
    <div class="row g-3">
        <div class="col-md-7 border-end">
            <div class="row g-2">
                <div class="col-12 mb-2">
                    <label class="form-label fw-bold text-primary">Base Shape Type</label>
                    <select id="pt-shape-type" class="form-select border-primary bg-light-subtle" onchange="handleShapeChange()">
                        <optgroup label="Standard">
                            <option value="RECT">Standard Rectangle</option>
                            <option value="CIRC">Circular / Disk</option>
                        </optgroup>
                        <optgroup label="Complex (CNC Path Required)">
                            <option value="L_SHAPE">L-Shape (Corner)</option>
                            <option value="U_SHAPE">U-Shape (Channel)</option>
                            <option value="RADIUS_CNR">Radius Corner</option>
                            <option value="CLIP">Clipped Corner</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="col-md-4" id="col-len">
                    <label id="lbl-len" class="form-label small fw-semibold">Length Equation</label>
                    <input id="pt-len-eq" class="form-control font-monospace" placeholder="e.g., L">
                </div>
                <div class="col-md-4" id="col-wid">
                    <label id="lbl-wid" class="form-label small fw-semibold">Width Equation</label>
                    <input id="pt-wid-eq" class="form-control font-monospace" placeholder="e.g., W">
                </div>
                <div class="col-md-4">
                    <label class="form-label small fw-semibold">Qty Equation</label>
                    <input id="pt-qty-eq" class="form-control font-monospace" value="1">
                </div>
                
                <div id="pt-extra-params" class="col-12 mt-2 d-none">
                    <div class="row g-2">
                        <div class="col-md-6" id="col-p1">
                            <label id="lbl-p1" class="form-label small fw-bold text-danger">Param 1</label>
                            <input id="pt-p1-eq" class="form-control form-control-sm font-monospace">
                        </div>
                        <div class="col-md-6" id="col-p2">
                            <label id="lbl-p2" class="form-label small fw-bold text-danger">Param 2</label>
                            <input id="pt-p2-eq" class="form-control form-control-sm font-monospace">
                        </div>
                    </div>
                </div>
            </div>
            <hr class="my-3">
            <label class="form-label fw-bold m-0 small text-muted">2D SVG / CNC Path</label>
            <textarea id="pt-svg" rows="3" class="form-control font-monospace small mt-1" oninput="updateSVGPreview()"></textarea>
        </div>

        <div class="col-md-5">
            <div class="d-flex justify-content-between align-items-center mb-1">
                <label class="form-label small fw-bold text-muted m-0">Edgeband Mapping</label>
                <button type="button" class="btn btn-link btn-sm p-0 text-danger text-decoration-none" style="font-size: 0.7rem;" onclick="window.resetBanding()">
                    Reset All
                </button>
            </div>

            <div id="pt-svg-preview-container" class="border rounded bg-white d-flex align-items-center justify-content-center shadow-sm" 
                 style="height: 160px; position: relative; border-style: dashed !important;">
                
                <svg id="part-preview-svg" viewBox="0 0 100 100" width="100%" height="100%" preserveAspectRatio="xMidYMid meet">
                    <rect x="20" y="20" width="60" height="60" fill="rgba(13, 110, 253, 0.05)" pointer-events="none" />
                    
                    <path id="path-top" d="M 20,20 L 80,20" stroke="#dee2e6" stroke-width="8" fill="transparent" onclick="window.toggleEdgeClick('top')" cursor="pointer" />
                    <path id="path-right" d="M 80,20 L 80,80" stroke="#dee2e6" stroke-width="8" fill="transparent" onclick="window.toggleEdgeClick('right')" cursor="pointer" />
                    <path id="path-bottom" d="M 80,80 L 20,80" stroke="#dee2e6" stroke-width="8" fill="transparent" onclick="window.toggleEdgeClick('bottom')" cursor="pointer" />
                    <path id="path-left" d="M 20,80 L 20,20" stroke="#dee2e6" stroke-width="8" fill="transparent" onclick="window.toggleEdgeClick('left')" cursor="pointer" />
                    
                    <text x="50" y="53" text-anchor="middle" font-size="6" fill="#adb5bd" pointer-events="none" font-weight="bold">CLICK EDGES</text>
                </svg>

                <div class="d-none">
                    <input type="checkbox" id="eb-top">
                    <input type="checkbox" id="eb-right">
                    <input type="checkbox" id="eb-bottom">
                    <input type="checkbox" id="eb-left">
                </div>
            </div>
            
            <div id="edgeband-summary-text" class="x-small text-center mt-2 text-primary fw-semibold" style="font-size: 0.75rem;">
                Raw Edges
            </div>
        </div>
    </div>
</div>


<div class="tab-pane fade" id="pt-material">
    <h6 class="mb-2 fw-bold text-secondary">Advanced Filters</h6>
    <div class="row g-2 mb-3">
        <div class="col-md-4">
          <label class="form-label small fw-semibold text-muted">Material Group</label>
            <select id="filter-material-group" class="form-select form-select-sm">
                <option value="">All Groups</option>
            </select>
        </div>
        <div class="col-md-4">
          <label class="form-label small fw-semibold text-muted">Material Type</label>
            <select id="filter-material-type" class="form-select form-select-sm">
                <option value="">All Types</option>
            </select>
        </div>
        <div class="col-md-4">
          <label class="form-label small fw-semibold text-muted">Material Model</label>
            <select id="filter-material-model" class="form-select form-select-sm">
                <option value="">All Models</option>
            </select>
        </div>
        <div class="col-md-6">
          <label class="form-label small fw-semibold text-muted">Material Brand</label>
            <select id="filter-material-brand" class="form-select form-select-sm">
                <option value="">All Brands</option>
            </select>
        </div>
        <div class="col-md-6">
          <label class="form-label small fw-semibold text-muted">Material thickness</label>
            <select id="filter-material-thickness" class="form-select form-select-sm">
                <option value="">All Thicknesses</option>
            </select>
        </div>
        <div class="col-md-4">
          <label class="form-label small fw-semibold text-muted">Grain Direction</label>
        <select id="filter-material-grain" class="form-select form-select-sm">
            <option value="">All Grain Types</option>
        </select>
    </div>
    </div>

    <div class="table-responsive border rounded" style="max-height: 250px; overflow-y: auto;">
    <table class="table table-sm table-hover align-middle m-0" style="font-size: 0.85rem;">
        <thead class="table-light sticky-top">
            <tr>
                <th>Material Name</th>
                <th>THK</th>
                <th class="text-center" style="width: 100px;">Whitelist</th>
            </tr>
        </thead>
        <tbody id="material-body">
            </tbody>
    </table>
</div>

    <div class="mt-3 p-2 bg-light border rounded">
    <div class="mb-1">
        <span class="small fw-bold text-muted text-uppercase">Active Whitelist:</span>
        <div id="selected-materials" class="mt-1 d-flex flex-wrap gap-1">
            <span class="text-muted small italic">No materials whitelisted</span>
        </div>
    </div>
    </div>
    </div>

<!-- ================= HARDWARE ================= -->
          <div class="tab-pane fade" id="pt-hardware">
    <div class="row g-2 mb-3 bg-light p-2 rounded border">
        <div class="col-md-6">
            <select class="form-select form-select-sm" id="hw-filter-group" onchange="renderHardwareTable()">
                <option value="">All Groups</option>
            </select>
        </div>
        <div class="col-md-6">
            <input type="text" class="form-control form-control-sm" id="hw-search" 
                   placeholder="Search hardware name..." onkeyup="renderHardwareTable()">
        </div>
    </div>

    <div class="table-responsive" style="max-height: 400px;">
        <table class="table table-sm table-hover align-middle">
            <thead class="table-light sticky-top">
                <tr>
                    <th style="width: 40px;"></th>
                    <th>Hardware Details</th>
                    <th style="width: 150px;">Quantity Eq.</th>
                    <th style="width: 150px;">Condition</th>
                </tr>
            </thead>
            <tbody id="pt-hardware-body">
                </tbody>
        </table>
    </div>
</div>

       
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button class="btn btn-success" id="save-part-template-btn">Save Part</button>
      </div>

    </div>
  </div>
</div>

